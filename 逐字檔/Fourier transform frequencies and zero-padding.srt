1
00:00:00,060 --> 00:00:08,490
we've discussed that EEG data contain or

2
00:00:04,500 --> 00:00:10,530
can be represented as a sum of of many

3
00:00:08,490 --> 00:00:12,259
sine waves each sine wave having a

4
00:00:10,529 --> 00:00:15,838
different frequency phase and amplitude

5
00:00:12,259 --> 00:00:18,210
but we also learned that there are lots

6
00:00:15,839 --> 00:00:21,778
of overlapping frequencies in the EEG

7
00:00:18,210 --> 00:00:23,699
signal and so how do we determine what

8
00:00:21,778 --> 00:00:27,028
frequencies are present in the signal to

9
00:00:23,699 --> 00:00:29,670
what extent and fortunately Joseph

10
00:00:27,028 --> 00:00:31,710
Fourier gave us the answer to this

11
00:00:29,670 --> 00:00:34,500
problem he gave us a way to address this

12
00:00:31,710 --> 00:00:36,539
problem through the Fourier theorem

13
00:00:34,500 --> 00:00:38,399
which states that any signal can be

14
00:00:36,539 --> 00:00:41,009
expressed as a combination of different

15
00:00:38,399 --> 00:00:46,200
sine waves each with its own frequency

16
00:00:41,009 --> 00:00:48,628
amplitude and phase we also learned how

17
00:00:46,200 --> 00:00:53,129
the discrete-time fourier transform

18
00:00:48,628 --> 00:00:56,429
works it works by taking the EEG signal

19
00:00:53,128 --> 00:00:58,920
so your data lining up or creating a

20
00:00:56,429 --> 00:01:01,409
bunch of sine waves that have different

21
00:00:58,920 --> 00:01:03,000
frequencies and of course as we

22
00:01:01,409 --> 00:01:05,879
discussed in the previous lecture these

23
00:01:03,000 --> 00:01:08,700
are complex sine waves as a real part

24
00:01:05,879 --> 00:01:10,530
and an imaginary part and then for each

25
00:01:08,700 --> 00:01:12,329
sine wave that's created you have to

26
00:01:10,530 --> 00:01:15,000
compute the dot product which is the

27
00:01:12,329 --> 00:01:16,829
point-wise multiplication between all of

28
00:01:15,000 --> 00:01:19,530
the points in the eg data and the sine

29
00:01:16,829 --> 00:01:23,908
wave and then you sum up all of these

30
00:01:19,530 --> 00:01:27,000
points to construct a or to result in a

31
00:01:23,909 --> 00:01:30,859
complex dot product from which you can

32
00:01:27,000 --> 00:01:34,170
extract amplitude and phase information

33
00:01:30,859 --> 00:01:36,118
and this step is of course repeated for

34
00:01:34,170 --> 00:01:38,640
multiple frequencies and this allows you

35
00:01:36,118 --> 00:01:40,618
to build up this frequency domain

36
00:01:38,640 --> 00:01:43,228
representation of the data

37
00:01:40,618 --> 00:01:47,578
fair enough this is all just a bit of

38
00:01:43,228 --> 00:01:50,069
quick review what I'd like to discuss in

39
00:01:47,578 --> 00:01:55,859
this video is how exactly we get to

40
00:01:50,069 --> 00:01:59,339
units of Hertz and this is an obviously

41
00:01:55,859 --> 00:02:00,930
important compart of frequency based

42
00:01:59,340 --> 00:02:02,000
analyses but it's also a bit of a

43
00:02:00,930 --> 00:02:03,930
non-trivial

44
00:02:02,000 --> 00:02:07,340
part and it can be a little bit

45
00:02:03,930 --> 00:02:10,349
confusing because when you looked at the

46
00:02:07,340 --> 00:02:13,330
MATLAB code for implementing the Fourier

47
00:02:10,348 --> 00:02:15,129
transform you may have noticed that the

48
00:02:13,330 --> 00:02:18,280
hi I'm variable the the vector that we

49
00:02:15,129 --> 00:02:20,409
created for time was not the same as the

50
00:02:18,280 --> 00:02:23,110
time variable that's used to create the

51
00:02:20,409 --> 00:02:25,180
original signal in fact the the time

52
00:02:23,110 --> 00:02:27,240
variable here goes from zero to

53
00:02:25,180 --> 00:02:31,270
something a little bit less than one

54
00:02:27,240 --> 00:02:33,850
regardless of what the what the unit of

55
00:02:31,270 --> 00:02:36,159
the original time domain signal was and

56
00:02:33,849 --> 00:02:39,939
in fact the Fourier transform doesn't

57
00:02:36,159 --> 00:02:44,740
even have any representation or inherent

58
00:02:39,939 --> 00:02:47,229
sort of understanding of of time or

59
00:02:44,740 --> 00:02:49,689
concept of of time we just called this

60
00:02:47,229 --> 00:02:51,639
variable time but the Fourier transform

61
00:02:49,689 --> 00:02:54,639
would look exactly the same if this

62
00:02:51,639 --> 00:02:57,309
variable were time in milliseconds or

63
00:02:54,639 --> 00:02:59,919
time in seconds or time in years or if

64
00:02:57,310 --> 00:03:04,840
it wasn't time at all if this was space

65
00:02:59,919 --> 00:03:07,329
if we were measuring fluctuations in in

66
00:03:04,840 --> 00:03:09,879
wave patterns in the ocean and our unit

67
00:03:07,330 --> 00:03:12,040
was meters so the Fourier transform is

68
00:03:09,879 --> 00:03:16,539
always the same so the question is how

69
00:03:12,039 --> 00:03:18,250
do we get from this arbitrary unit list

70
00:03:16,539 --> 00:03:20,949
vector that just goes from zero to

71
00:03:18,250 --> 00:03:24,550
something a little bit less than one how

72
00:03:20,949 --> 00:03:26,229
do we convert those indices to a metric

73
00:03:24,550 --> 00:03:29,080
that is more meaningful that we know how

74
00:03:26,229 --> 00:03:32,139
to interpret and how to work with which

75
00:03:29,080 --> 00:03:35,320
in our case is going to be Hertz for for

76
00:03:32,139 --> 00:03:38,169
brain data analyses so this is really

77
00:03:35,319 --> 00:03:42,669
the one of the main focuses of this

78
00:03:38,169 --> 00:03:45,208
lecture okay so our good friend Patrick

79
00:03:42,669 --> 00:03:48,309
McGoohan is back with us and he asked

80
00:03:45,209 --> 00:03:50,289
for you how many frequencies will you

81
00:03:48,310 --> 00:03:53,769
give us from your transform if we use

82
00:03:50,289 --> 00:03:55,449
your transform the Fourier says well he

83
00:03:53,769 --> 00:03:57,879
wants information of course and in

84
00:03:55,449 --> 00:04:01,509
return for the information you get n

85
00:03:57,879 --> 00:04:03,939
over 2 plus 1 frequencies so n is the

86
00:04:01,509 --> 00:04:06,729
number of time points that we have in

87
00:04:03,939 --> 00:04:10,000
the original time domain signal and now

88
00:04:06,729 --> 00:04:13,798
Fourier says we get n over 2 plus 1

89
00:04:10,000 --> 00:04:17,228
frequencies back when we use his

90
00:04:13,799 --> 00:04:19,600
transform so what does this number mean

91
00:04:17,228 --> 00:04:22,629
this may seem like a strange or

92
00:04:19,600 --> 00:04:23,250
arbitrary number n over 2 plus 1 where n

93
00:04:22,629 --> 00:04:25,949
is the number

94
00:04:23,250 --> 00:04:27,569
time points so let's take a few minutes

95
00:04:25,949 --> 00:04:29,729
to think about what this number might

96
00:04:27,569 --> 00:04:33,420
mean and why it might make sense

97
00:04:29,730 --> 00:04:35,790
first we'll think about what is the the

98
00:04:33,420 --> 00:04:37,710
highest frequency or the fastest

99
00:04:35,790 --> 00:04:43,260
sine wave that we can possibly measure

100
00:04:37,709 --> 00:04:45,419
in our data so if you think about a sine

101
00:04:43,259 --> 00:04:49,829
wave that has one cycle so there's a one

102
00:04:45,420 --> 00:04:52,170
cycle sine wave in order to represent

103
00:04:49,829 --> 00:04:55,349
this this sine wave or measure this sine

104
00:04:52,170 --> 00:04:58,050
wave we need to take a theoretical

105
00:04:55,350 --> 00:05:00,870
minimum of two data points so we need at

106
00:04:58,050 --> 00:05:03,360
least two data points to understand that

107
00:05:00,870 --> 00:05:06,090
this is a sine wave if we only had one

108
00:05:03,360 --> 00:05:07,620
data point then we would have one

109
00:05:06,089 --> 00:05:10,409
measurement here and one measurement

110
00:05:07,620 --> 00:05:11,939
over here at the next beak and then we

111
00:05:10,410 --> 00:05:14,520
wouldn't be able to determine whether

112
00:05:11,939 --> 00:05:15,750
this is a fluctuating pattern or just a

113
00:05:14,519 --> 00:05:18,000
straight line because the next

114
00:05:15,750 --> 00:05:22,110
measurement would be here so we need a

115
00:05:18,000 --> 00:05:25,439
minimum of two data points per cycle in

116
00:05:22,110 --> 00:05:27,449
order to measure a sine wave in order to

117
00:05:25,439 --> 00:05:30,168
extract sinusoidal information so this

118
00:05:27,449 --> 00:05:35,339
is the fastest frequency that we can

119
00:05:30,168 --> 00:05:37,529
that we can extract out of our data so

120
00:05:35,339 --> 00:05:40,949
having two points or two measurements

121
00:05:37,529 --> 00:05:43,139
per cycle corresponds to one half of the

122
00:05:40,949 --> 00:05:45,719
sampling rate so that's that's where we

123
00:05:43,139 --> 00:05:48,029
get the fastest frequency in Hertz is

124
00:05:45,720 --> 00:05:49,860
one half of the sampling rate this may

125
00:05:48,029 --> 00:05:52,079
ring a bell one half the sampling rate

126
00:05:49,860 --> 00:05:56,280
it has a particular name it's called the

127
00:05:52,079 --> 00:05:59,639
Nyquist frequency so yes the Nyquist

128
00:05:56,279 --> 00:06:02,279
frequency is nothing super sophisticated

129
00:05:59,639 --> 00:06:05,579
or complicated it's just one half of the

130
00:06:02,279 --> 00:06:08,579
sampling rate okay so this is the

131
00:06:05,579 --> 00:06:10,769
fastest frequency that we can get out of

132
00:06:08,579 --> 00:06:13,050
our data now let's think at the other

133
00:06:10,769 --> 00:06:16,019
extreme what is the slowest frequency

134
00:06:13,050 --> 00:06:18,930
that we can extract out of our data so

135
00:06:16,019 --> 00:06:20,728
we can think about sine waves slowing

136
00:06:18,930 --> 00:06:22,709
down so here's a sine wave with a

137
00:06:20,728 --> 00:06:24,560
frequency of four it doesn't matter if

138
00:06:22,709 --> 00:06:27,418
these are Hertz or whatever this is just

139
00:06:24,560 --> 00:06:30,990
numbers so and then a slower frequency

140
00:06:27,418 --> 00:06:35,219
would be to an even slower frequency

141
00:06:30,990 --> 00:06:36,449
would be one so now we can think even

142
00:06:35,220 --> 00:06:39,389
slower what is the

143
00:06:36,449 --> 00:06:39,900
the lowest frequency that we can think

144
00:06:39,389 --> 00:06:42,598
of

145
00:06:39,899 --> 00:06:45,149
turns out it's it's zero a frequency of

146
00:06:42,598 --> 00:06:48,478
zero or a sine wave with with zero Hertz

147
00:06:45,149 --> 00:06:51,478
this may initially seem strange you know

148
00:06:48,478 --> 00:06:54,300
that there is a sine wave that has zero

149
00:06:51,478 --> 00:06:56,248
Hertz but in fact a sine wave with zero

150
00:06:54,300 --> 00:06:59,158
Hertz is just a flat line as you can see

151
00:06:56,249 --> 00:07:03,599
here we often call this the DC component

152
00:06:59,158 --> 00:07:06,620
or a DC stands for direct current is the

153
00:07:03,598 --> 00:07:09,449
term from engineering from electricity

154
00:07:06,620 --> 00:07:11,490
because this is a direct current and all

155
00:07:09,449 --> 00:07:15,569
these would be examples of alternating

156
00:07:11,490 --> 00:07:17,699
current or AC components so this lowest

157
00:07:15,569 --> 00:07:19,979
frequency that we can possibly extract

158
00:07:17,699 --> 00:07:23,908
from the data is called the zero

159
00:07:19,978 --> 00:07:26,519
frequency or zero Hertz or the DC

160
00:07:23,908 --> 00:07:29,188
component this basically captures the

161
00:07:26,519 --> 00:07:31,680
mean offset of the data and I will we'll

162
00:07:29,189 --> 00:07:36,468
we'll see how this works in MATLAB in a

163
00:07:31,680 --> 00:07:40,550
few minutes okay so now we know the two

164
00:07:36,468 --> 00:07:43,259
extremes of the frequencies we get

165
00:07:40,550 --> 00:07:45,329
whenever we do a Fourier transform we

166
00:07:43,259 --> 00:07:49,949
always have zero frequency that's the

167
00:07:45,329 --> 00:07:52,620
lowest frequency that can be measured or

168
00:07:49,949 --> 00:07:54,629
that can be defined even and then we

169
00:07:52,620 --> 00:07:56,639
always have the Nyquist frequency the

170
00:07:54,629 --> 00:07:58,349
Nyquist frequency is defined by the

171
00:07:56,639 --> 00:08:00,509
sampling rate so whatever the sampling

172
00:07:58,348 --> 00:08:02,908
rate is the highest frequency that we

173
00:08:00,509 --> 00:08:06,658
can extract from the data is the

174
00:08:02,908 --> 00:08:08,519
sampling rate over to okay so now when

175
00:08:06,658 --> 00:08:11,759
we go from something a little bit bigger

176
00:08:08,519 --> 00:08:15,748
than zero to the Nyquist frequency this

177
00:08:11,759 --> 00:08:17,999
gives us our n over two and the zero

178
00:08:15,749 --> 00:08:20,729
frequency the DC component gives us our

179
00:08:17,999 --> 00:08:23,789
plus one so this is how we get n over

180
00:08:20,728 --> 00:08:28,228
two plus one frequencies from the

181
00:08:23,788 --> 00:08:32,429
Fourier transform so this on its own may

182
00:08:28,228 --> 00:08:35,490
may seem sensible but this may also seem

183
00:08:32,429 --> 00:08:37,198
inconsistent with what you saw in the

184
00:08:35,490 --> 00:08:39,658
implementation of the Fourier transform

185
00:08:37,198 --> 00:08:43,019
in MATLAB and in particular here we saw

186
00:08:39,658 --> 00:08:45,568
that the sine waves are not only created

187
00:08:43,019 --> 00:08:48,089
up to n over two plus one the sine waves

188
00:08:45,568 --> 00:08:49,169
are created all the way up to n so here

189
00:08:48,089 --> 00:08:51,690
I'm saying that we have

190
00:08:49,169 --> 00:08:53,129
and over two plus one frequencies but

191
00:08:51,690 --> 00:08:56,390
here when you look at the amount of code

192
00:08:53,129 --> 00:08:59,789
you see we actually get n frequencies so

193
00:08:56,389 --> 00:09:03,569
so what is up with this when is the deal

194
00:08:59,789 --> 00:09:07,259
at this so it turns out that things are

195
00:09:03,570 --> 00:09:10,530
a little bit more complicated and if you

196
00:09:07,259 --> 00:09:13,350
have looked at a at the result of a

197
00:09:10,529 --> 00:09:17,100
Fourier transform you probably notice

198
00:09:13,350 --> 00:09:19,200
that the frequency characteristics or

199
00:09:17,100 --> 00:09:21,930
the frequencies don't stop at the

200
00:09:19,200 --> 00:09:24,660
Nyquist frequency they continue going up

201
00:09:21,929 --> 00:09:28,799
after are going along after the Nyquist

202
00:09:24,659 --> 00:09:31,409
frequency and if you have a real-valued

203
00:09:28,799 --> 00:09:33,679
signal so a signal that only contains

204
00:09:31,409 --> 00:09:36,659
real parts and not imaginary numbers

205
00:09:33,679 --> 00:09:38,209
then you would also or you may also you

206
00:09:36,659 --> 00:09:42,600
might also have noticed that the

207
00:09:38,210 --> 00:09:44,610
frequencies past the Nyquist are mirror

208
00:09:42,600 --> 00:09:46,170
images so whatever you see on this side

209
00:09:44,610 --> 00:09:48,149
it's flipped and you see that on this

210
00:09:46,169 --> 00:09:49,769
side so what's going on with these

211
00:09:48,149 --> 00:09:51,870
frequencies that are actually higher

212
00:09:49,769 --> 00:09:53,549
than the Nyquist frequency when I just

213
00:09:51,870 --> 00:09:56,879
told you that these frequencies cannot

214
00:09:53,549 --> 00:09:58,379
be measured in the signal well maybe you

215
00:09:56,879 --> 00:10:00,179
think that these are like the evil

216
00:09:58,379 --> 00:10:02,370
frequencies or something it turns out

217
00:10:00,179 --> 00:10:05,669
they're not so bad we call them the

218
00:10:02,370 --> 00:10:08,399
negative frequencies a little bit

219
00:10:05,669 --> 00:10:11,879
initially of a strange concept that

220
00:10:08,399 --> 00:10:14,549
frequencies can be negative but you have

221
00:10:11,879 --> 00:10:17,970
to you can think about that sine waves

222
00:10:14,549 --> 00:10:19,529
have not only frequency and phase and

223
00:10:17,970 --> 00:10:21,330
amplitude but sine waves also have

224
00:10:19,529 --> 00:10:24,389
direction and so the positive

225
00:10:21,330 --> 00:10:26,520
frequencies correspond to sine waves

226
00:10:24,389 --> 00:10:28,559
that go one direction and the negative

227
00:10:26,519 --> 00:10:31,259
frequencies correspond to sine waves

228
00:10:28,559 --> 00:10:35,039
that go the other direction in in a

229
00:10:31,259 --> 00:10:40,529
polar plane now for real valued signals

230
00:10:35,039 --> 00:10:42,360
like EEG and LFP and mu G signals we

231
00:10:40,529 --> 00:10:43,980
don't have to really worry about the

232
00:10:42,360 --> 00:10:46,259
negative frequencies because the

233
00:10:43,980 --> 00:10:48,870
negative frequencies are only different

234
00:10:46,259 --> 00:10:50,850
from the positive frequencies if you

235
00:10:48,870 --> 00:10:52,950
have a complex signal if you're taking

236
00:10:50,850 --> 00:10:54,750
the Fourier transform of a complex

237
00:10:52,950 --> 00:10:57,240
signal a signal and as a real part and

238
00:10:54,750 --> 00:10:59,850
an imaginary part but generally in

239
00:10:57,240 --> 00:11:02,519
neuroscience we only start with real

240
00:10:59,850 --> 00:11:04,470
valued signals and so in this case

241
00:11:02,519 --> 00:11:07,289
negative frequencies simply mirror the

242
00:11:04,470 --> 00:11:10,080
positive frequencies in fact the

243
00:11:07,289 --> 00:11:11,669
amplitudes get split in half between the

244
00:11:10,080 --> 00:11:14,960
positive frequencies and negative

245
00:11:11,669 --> 00:11:17,250
frequencies so to reconstruct the

246
00:11:14,960 --> 00:11:19,500
amplitudes in your signal what you have

247
00:11:17,250 --> 00:11:21,960
to do is take the negative frequencies

248
00:11:19,500 --> 00:11:25,590
or take the amplitudes from the negative

249
00:11:21,960 --> 00:11:28,740
frequencies and map those back onto the

250
00:11:25,590 --> 00:11:30,120
positive frequencies in practice you

251
00:11:28,740 --> 00:11:32,009
don't have to do any of this mirroring

252
00:11:30,120 --> 00:11:34,620
stuff you just ignore all the negative

253
00:11:32,009 --> 00:11:36,450
frequencies and double all the positive

254
00:11:34,620 --> 00:11:42,269
frequencies so I'll show you how this

255
00:11:36,450 --> 00:11:44,430
works in MATLAB in a few minutes oh I'm

256
00:11:42,269 --> 00:11:48,480
gonna show you very soon okay so now we

257
00:11:44,429 --> 00:11:51,269
can switch to MATLAB so here I've

258
00:11:48,480 --> 00:11:53,490
created a signal this is just some

259
00:11:51,269 --> 00:11:56,069
arbitrary random numbers that I just

260
00:11:53,490 --> 00:11:59,279
came up with and here we take the

261
00:11:56,070 --> 00:12:01,170
Fourier transform of the signal and now

262
00:11:59,279 --> 00:12:05,850
we're gonna plot the signal and it's

263
00:12:01,169 --> 00:12:08,519
Fourier transform so here you see the

264
00:12:05,850 --> 00:12:09,600
signal and now you can already see well

265
00:12:08,519 --> 00:12:12,000
first of all we don't know what the

266
00:12:09,600 --> 00:12:14,340
units are right I haven't specified a

267
00:12:12,000 --> 00:12:16,919
sampling rate we don't know if these are

268
00:12:14,340 --> 00:12:19,800
measurements in milliseconds or seconds

269
00:12:16,919 --> 00:12:22,529
or or decades so that means we also

270
00:12:19,799 --> 00:12:24,629
don't know what the unit is for the

271
00:12:22,529 --> 00:12:27,659
Fourier transform but what you should

272
00:12:24,629 --> 00:12:29,759
see here is that these are units and

273
00:12:27,659 --> 00:12:31,620
here is is somewhere in the middle and

274
00:12:29,759 --> 00:12:33,929
now you can see that the positive

275
00:12:31,620 --> 00:12:36,000
frequencies and the negative frequencies

276
00:12:33,929 --> 00:12:38,549
are mirror image of each other so what

277
00:12:36,000 --> 00:12:40,559
you see going this way is the same as

278
00:12:38,549 --> 00:12:42,740
what you see going this way and the kind

279
00:12:40,559 --> 00:12:48,689
of anchor point in the center is the

280
00:12:42,740 --> 00:12:51,799
Nyquist frequency okay so now what I'm

281
00:12:48,690 --> 00:12:54,330
going to do is just also make up a

282
00:12:51,799 --> 00:12:57,240
sampling rate so I just specify that

283
00:12:54,330 --> 00:13:02,460
these data were sampled at 100 Hertz

284
00:12:57,240 --> 00:13:07,350
that allows us to create a or convert

285
00:13:02,460 --> 00:13:12,509
these indices from from meaningless

286
00:13:07,350 --> 00:13:14,940
units into into into Hertz and so here

287
00:13:12,509 --> 00:13:18,059
we do that so we may say that there

288
00:13:14,940 --> 00:13:19,920
our frequencies between zero and the

289
00:13:18,059 --> 00:13:22,500
Nyquist frequency half the sampling rate

290
00:13:19,919 --> 00:13:25,490
and the number of frequencies that we

291
00:13:22,500 --> 00:13:28,710
have in between zero and the Nyquist is

292
00:13:25,490 --> 00:13:32,039
n over two plus one so here is n the

293
00:13:28,710 --> 00:13:34,230
length of our signal over two and plus

294
00:13:32,039 --> 00:13:37,860
one and the floor here that that means

295
00:13:34,230 --> 00:13:40,909
round down and that's in there just in

296
00:13:37,860 --> 00:13:47,759
case the signal is an odd number of

297
00:13:40,909 --> 00:13:49,620
points okay so now you can see this new

298
00:13:47,759 --> 00:13:51,000
figure now we're able to convert this

299
00:13:49,620 --> 00:13:54,090
into Hertz so we know that these are

300
00:13:51,000 --> 00:13:57,299
time points in milliseconds and you can

301
00:13:54,090 --> 00:13:59,730
see here what we saw here is the

302
00:13:57,299 --> 00:14:02,370
frequency indices as just the first

303
00:13:59,730 --> 00:14:04,769
index the second index the third index

304
00:14:02,370 --> 00:14:08,310
now we are able to convert this into

305
00:14:04,769 --> 00:14:11,429
Hertz so this is zero Hartz the DC

306
00:14:08,309 --> 00:14:13,439
component and this is 7.1 Hertz and

307
00:14:11,429 --> 00:14:17,579
fourteen points something Hertz and

308
00:14:13,440 --> 00:14:21,450
whatever else it is okay so now I would

309
00:14:17,580 --> 00:14:23,490
like to show you the how the the DC or

310
00:14:21,450 --> 00:14:26,240
the zero frequency component fits in

311
00:14:23,490 --> 00:14:29,820
here so here what I'm doing is creating

312
00:14:26,240 --> 00:14:32,789
or computing the Fourier transform of

313
00:14:29,820 --> 00:14:35,129
this signal three different times first

314
00:14:32,789 --> 00:14:38,069
is the original signal and then what I

315
00:14:35,129 --> 00:14:41,549
do is take the Fourier transform of the

316
00:14:38,070 --> 00:14:44,100
signal after subtracting the mean offset

317
00:14:41,549 --> 00:14:46,199
so I'm just yeah so here we just compute

318
00:14:44,100 --> 00:14:48,120
the mean and then subtract it and here

319
00:14:46,200 --> 00:14:50,070
we compute the mean and then add it so

320
00:14:48,120 --> 00:14:56,669
we're now just going to add some offset

321
00:14:50,070 --> 00:14:58,500
to this signal so first let me plot just

322
00:14:56,669 --> 00:15:00,329
the time domain representations of these

323
00:14:58,500 --> 00:15:02,940
signals so here I just compute the

324
00:15:00,330 --> 00:15:05,100
inverse Fourier transform of the signal

325
00:15:02,940 --> 00:15:07,290
so we get the signal back in the time

326
00:15:05,100 --> 00:15:09,899
domain you can see all three of these

327
00:15:07,289 --> 00:15:13,110
versions of the signal look really

328
00:15:09,899 --> 00:15:15,840
similar but they're shifted a little bit

329
00:15:13,110 --> 00:15:18,090
on the y-axis so that makes sense it's

330
00:15:15,840 --> 00:15:20,070
the same signal in all three cases all

331
00:15:18,090 --> 00:15:23,009
I've done is subtract the mean or add

332
00:15:20,070 --> 00:15:27,330
the mean so it's just a shift

333
00:15:23,009 --> 00:15:31,500
in the y-axis now let's see what happens

334
00:15:27,330 --> 00:15:33,960
in the frequency domain so now you can

335
00:15:31,500 --> 00:15:36,919
see the frequency domain representation

336
00:15:33,960 --> 00:15:39,629
of all of these or these three signals

337
00:15:36,919 --> 00:15:41,969
ignore the the zero frequency for now

338
00:15:39,629 --> 00:15:44,909
we'll get back to that in a second all

339
00:15:41,970 --> 00:15:47,940
of these components have exactly the

340
00:15:44,909 --> 00:15:49,949
same Fourier coefficients for these

341
00:15:47,940 --> 00:15:52,620
three signals even though they do differ

342
00:15:49,950 --> 00:15:56,280
a little bit and this is actually not

343
00:15:52,620 --> 00:15:58,139
just a question of of scale because if

344
00:15:56,279 --> 00:16:01,709
you zoom in it actually doesn't matter

345
00:15:58,139 --> 00:16:06,539
how much you zoom in Haysville always be

346
00:16:01,710 --> 00:16:08,460
perfectly perfectly overlapping and this

347
00:16:06,539 --> 00:16:10,969
should actually make sense because the

348
00:16:08,460 --> 00:16:13,680
rhythmic components in this signal are

349
00:16:10,970 --> 00:16:16,290
exactly the same whether we push the

350
00:16:13,679 --> 00:16:18,509
signal up or down on the y-axis so all

351
00:16:16,289 --> 00:16:21,209
of these nonzero frequencies should be

352
00:16:18,509 --> 00:16:24,389
exactly the same the only way that these

353
00:16:21,210 --> 00:16:27,870
three versions of this signal differ is

354
00:16:24,389 --> 00:16:30,840
in the DC component or the zero

355
00:16:27,870 --> 00:16:32,909
frequency component and here in

356
00:16:30,840 --> 00:16:34,680
particular you can see when we demeaned

357
00:16:32,909 --> 00:16:38,009
the signal when we subtracted the mean

358
00:16:34,679 --> 00:16:40,439
of the signal then the DC component went

359
00:16:38,009 --> 00:16:42,659
to zero so this actually makes a lot of

360
00:16:40,440 --> 00:16:45,300
sense the DC component reflects the mean

361
00:16:42,659 --> 00:16:47,250
offset so we subtract the mean so we

362
00:16:45,299 --> 00:16:51,509
have a zero mean and then we have a DC

363
00:16:47,250 --> 00:16:54,690
of zero okay so I'd like to take this

364
00:16:51,509 --> 00:16:56,789
one step further and now instead of it

365
00:16:54,690 --> 00:16:59,880
adding back the mean we can add just a

366
00:16:56,789 --> 00:17:03,539
number like let's say 10 so now if we

367
00:16:59,879 --> 00:17:05,640
run this cell again you see again these

368
00:17:03,539 --> 00:17:08,099
three time series are similar in terms

369
00:17:05,640 --> 00:17:10,530
of their fluctuations but the one that I

370
00:17:08,099 --> 00:17:13,740
added tend to as a offset of 10 else

371
00:17:10,529 --> 00:17:15,449
that's what I defined so now in the

372
00:17:13,740 --> 00:17:17,459
frequency domain of course all these

373
00:17:15,449 --> 00:17:21,000
nonzero frequency components are

374
00:17:17,459 --> 00:17:25,610
identical but the zero frequency

375
00:17:21,000 --> 00:17:27,240
component has 20 so this may seem

376
00:17:25,609 --> 00:17:31,289
incongruent because you probably

377
00:17:27,240 --> 00:17:33,130
expected this to be 10 because the the

378
00:17:31,289 --> 00:17:35,918
the mean offset of this

379
00:17:33,130 --> 00:17:37,539
is a little bit over 10 it's 10 plus

380
00:17:35,919 --> 00:17:41,320
whatever the mean of this signal is so

381
00:17:37,538 --> 00:17:43,660
it should actually be just over 10 so it

382
00:17:41,319 --> 00:17:46,750
turns out that I cheated a little bit

383
00:17:43,660 --> 00:17:49,900
here I took a bit of a shortcut here now

384
00:17:46,750 --> 00:17:53,160
remember I said in the in the PowerPoint

385
00:17:49,900 --> 00:17:55,538
slide that to accurately estimate the

386
00:17:53,160 --> 00:17:57,759
amplitudes from the Fourier transform

387
00:17:55,538 --> 00:17:59,500
you have to fold the negative

388
00:17:57,759 --> 00:18:02,048
frequencies back onto the positive

389
00:17:59,500 --> 00:18:05,409
frequencies which you can effectively do

390
00:18:02,048 --> 00:18:08,019
just by doubling the positive

391
00:18:05,409 --> 00:18:10,270
frequencies so that's what I do here so

392
00:18:08,019 --> 00:18:13,599
it turns out that there's it's a little

393
00:18:10,269 --> 00:18:16,500
bit more subtle than this because only

394
00:18:13,599 --> 00:18:20,019
the nonzero and non Nyquist frequency

395
00:18:16,500 --> 00:18:21,759
components have a corresponding or a

396
00:18:20,019 --> 00:18:25,240
complimentary negative frequency

397
00:18:21,759 --> 00:18:28,150
component and this should make sense in

398
00:18:25,240 --> 00:18:30,940
particular for for zero there is no

399
00:18:28,150 --> 00:18:33,190
negative of zero negative zero is zero

400
00:18:30,940 --> 00:18:37,538
so there's no such thing as a negative

401
00:18:33,190 --> 00:18:40,720
complement of zero so in fact if you

402
00:18:37,538 --> 00:18:43,569
want to accurately estimate the

403
00:18:40,720 --> 00:18:46,589
amplitude of the positive 3 or of the

404
00:18:43,569 --> 00:18:48,700
Fourier transform you do not simply

405
00:18:46,589 --> 00:18:51,490
multiply everything by 2

406
00:18:48,700 --> 00:18:56,169
the really correct way to do it would be

407
00:18:51,490 --> 00:18:58,359
to multiply the frequency components by

408
00:18:56,169 --> 00:19:02,590
two only for the frequency components

409
00:18:58,359 --> 00:19:05,589
that are between but not including the

410
00:19:02,589 --> 00:19:07,418
DC component the zero frequency and the

411
00:19:05,589 --> 00:19:10,349
Nyquist frequency so here I'm

412
00:19:07,419 --> 00:19:13,600
multiplying all the plot all of the

413
00:19:10,349 --> 00:19:17,379
frequencies by two so this is a little

414
00:19:13,599 --> 00:19:20,678
bit of a lazy shortcut but I wanted to

415
00:19:17,380 --> 00:19:23,770
have this in here to illustrate how this

416
00:19:20,679 --> 00:19:26,860
works so you can imagine if we would not

417
00:19:23,769 --> 00:19:29,349
multiply the zero frequency component by

418
00:19:26,859 --> 00:19:31,359
two then this would be something just

419
00:19:29,349 --> 00:19:36,579
over 10 which is accurate that's what it

420
00:19:31,359 --> 00:19:39,519
should be in practice for real EEG data

421
00:19:36,579 --> 00:19:41,678
analyses it's often useful to subtract

422
00:19:39,519 --> 00:19:43,210
the mean component because in general

423
00:19:41,679 --> 00:19:47,200
we're not really interested in the mean

424
00:19:43,210 --> 00:19:49,660
offset across a larger x

425
00:19:47,200 --> 00:19:53,590
so in general you will want to subtract

426
00:19:49,660 --> 00:19:56,170
the the mean from your signal before you

427
00:19:53,589 --> 00:19:58,449
compute the Fourier transform kind of

428
00:19:56,170 --> 00:20:01,090
like what we do here in version 2 of

429
00:19:58,450 --> 00:20:04,450
this signal and so in that case it's

430
00:20:01,089 --> 00:20:06,250
kind of it's okay to to use this lazy

431
00:20:04,450 --> 00:20:10,840
shortcut of multiplying everything by

432
00:20:06,250 --> 00:20:19,900
two because if the DC potential is is 0

433
00:20:10,839 --> 00:20:22,929
then 2 times 0 is still 0 so ok so now

434
00:20:19,900 --> 00:20:25,390
we see that when we compute a Fourier

435
00:20:22,930 --> 00:20:28,450
transform the frequencies we get are

436
00:20:25,390 --> 00:20:31,600
always between 0 and the Nyquist

437
00:20:28,450 --> 00:20:34,059
frequency and the Nyquist frequency is

438
00:20:31,599 --> 00:20:36,879
defined by half the sampling rate so the

439
00:20:34,059 --> 00:20:39,819
next question is how many points are

440
00:20:36,880 --> 00:20:43,680
there between 0 and the Nyquist

441
00:20:39,819 --> 00:20:48,069
frequency so this is where the N over 2

442
00:20:43,680 --> 00:20:50,880
part comes in so n is the number of data

443
00:20:48,069 --> 00:20:54,819
points that you have in your time series

444
00:20:50,880 --> 00:20:57,340
and so the more data points you have in

445
00:20:54,819 --> 00:20:59,470
your time series the more frequencies

446
00:20:57,339 --> 00:21:01,779
you will get in between 0 and the

447
00:20:59,470 --> 00:21:03,730
Nyquist you will never be able to get

448
00:21:01,779 --> 00:21:06,430
higher frequencies than the Nyquist

449
00:21:03,730 --> 00:21:07,930
unless you change your sampling rate but

450
00:21:06,430 --> 00:21:09,910
if you have a few data points you might

451
00:21:07,930 --> 00:21:12,130
have a frequency resolution that looks

452
00:21:09,910 --> 00:21:13,630
something like this if you have more

453
00:21:12,130 --> 00:21:16,390
data points you will have a higher

454
00:21:13,630 --> 00:21:18,100
resolution still you only get up to the

455
00:21:16,390 --> 00:21:21,910
Nyquist frequency but you have more data

456
00:21:18,099 --> 00:21:23,859
points before the Nyquist frequency and

457
00:21:21,910 --> 00:21:25,630
then you could have really SuperDuper a

458
00:21:23,859 --> 00:21:28,709
lot of data points and then you get very

459
00:21:25,630 --> 00:21:31,330
high resolution you have more

460
00:21:28,710 --> 00:21:33,970
frequencies between 0 and the Nyquist

461
00:21:31,329 --> 00:21:37,029
still you can see it doesn't matter how

462
00:21:33,970 --> 00:21:39,579
many points you have in your time series

463
00:21:37,029 --> 00:21:41,259
you can only over ever go up to the

464
00:21:39,579 --> 00:21:43,689
Nyquist frequency so if the sampling

465
00:21:41,259 --> 00:21:45,190
rate stays the same the highest

466
00:21:43,690 --> 00:21:48,840
frequency you can reconstruct will

467
00:21:45,190 --> 00:21:52,600
always stay the same and so yeah so in

468
00:21:48,839 --> 00:21:55,269
MATLAB we interpret this or we implement

469
00:21:52,599 --> 00:21:58,149
this as the function linspace of

470
00:21:55,269 --> 00:22:00,730
linearly spaced numbers always between 0

471
00:21:58,150 --> 00:22:03,490
always between the Nyquist

472
00:22:00,730 --> 00:22:08,529
and going up and the number of steps

473
00:22:03,490 --> 00:22:12,130
corresponds to n over 2 plus 1 I find

474
00:22:08,529 --> 00:22:14,079
that this is a is a is a tricky and

475
00:22:12,130 --> 00:22:16,980
subtle point and many students get

476
00:22:14,079 --> 00:22:19,869
confused about the difference between

477
00:22:16,980 --> 00:22:22,269
getting up to the to the sampling rate

478
00:22:19,869 --> 00:22:25,359
or the Nyquist frequency versus the

479
00:22:22,269 --> 00:22:27,339
number of of time points or your

480
00:22:25,359 --> 00:22:31,479
frequency resolution between 0 and the

481
00:22:27,339 --> 00:22:33,519
Nyquist frequency and so because this is

482
00:22:31,480 --> 00:22:36,940
a tricky point so we're gonna have so

483
00:22:33,519 --> 00:22:39,910
now I'll have this MATLAB simulation

484
00:22:36,940 --> 00:22:42,009
that's going to I hope illustrate for

485
00:22:39,910 --> 00:22:43,840
you and and show you very clearly what

486
00:22:42,009 --> 00:22:45,819
this distinction is and how these relate

487
00:22:43,839 --> 00:22:51,220
to each other so what we're going to do

488
00:22:45,819 --> 00:22:53,559
is create the same signal using

489
00:22:51,220 --> 00:22:55,870
different sampling rates of either a

490
00:22:53,559 --> 00:22:58,619
hundred Hertz or a thousand Hertz or you

491
00:22:55,869 --> 00:23:01,500
might also call this a kilohertz and

492
00:22:58,619 --> 00:23:04,419
different time durations well either

493
00:23:01,500 --> 00:23:06,250
well here we list one second ten seconds

494
00:23:04,420 --> 00:23:07,779
one second but actually there's another

495
00:23:06,250 --> 00:23:11,109
second added on so there's really going

496
00:23:07,779 --> 00:23:16,480
to be two seconds versus 11 seconds okay

497
00:23:11,109 --> 00:23:19,389
and what we are going to do is construct

498
00:23:16,480 --> 00:23:22,450
a signal so here I'm just defining the

499
00:23:19,390 --> 00:23:24,880
sampling rate for this iteration and the

500
00:23:22,450 --> 00:23:26,559
time vector for this iteration you can

501
00:23:24,880 --> 00:23:28,060
see we always start at minus one and

502
00:23:26,559 --> 00:23:32,889
then we go up to whatever is specified

503
00:23:28,059 --> 00:23:35,109
by this this vector up here we are going

504
00:23:32,890 --> 00:23:36,790
to create a signal called a Morley

505
00:23:35,109 --> 00:23:38,889
wavelet this is a real-valued Morley

506
00:23:36,789 --> 00:23:41,259
wavelet we are going to discuss more

507
00:23:38,890 --> 00:23:43,900
they wavelets in much more depth in the

508
00:23:41,259 --> 00:23:45,849
next section of these lectures where we

509
00:23:43,900 --> 00:23:48,700
talk about time frequency decomposition

510
00:23:45,849 --> 00:23:53,079
but you should already be able to look

511
00:23:48,700 --> 00:23:56,470
at line 94 and see that there is a sine

512
00:23:53,079 --> 00:23:58,990
wave here so it's 2 pi F T and there is

513
00:23:56,470 --> 00:24:02,309
a Gaussian so e to the minus T squared

514
00:23:58,990 --> 00:24:07,870
over something which is 2 s squared and

515
00:24:02,309 --> 00:24:09,279
this produces a a Morley wavelet ok but

516
00:24:07,869 --> 00:24:10,719
for now the characteristics of the

517
00:24:09,279 --> 00:24:13,149
signal don't matter we just want

518
00:24:10,720 --> 00:24:13,900
something to look at so here we create

519
00:24:13,150 --> 00:24:16,570
the time

520
00:24:13,900 --> 00:24:19,750
version of the signal and here we create

521
00:24:16,569 --> 00:24:22,149
the frequency domain of the signal or we

522
00:24:19,750 --> 00:24:24,910
compute the frequency representation of

523
00:24:22,150 --> 00:24:28,120
the signal and this line 98 here we are

524
00:24:24,910 --> 00:24:29,980
just scale amplitude scaling the

525
00:24:28,119 --> 00:24:33,909
frequency representation just to make it

526
00:24:29,980 --> 00:24:36,759
easier to look at okay so now we can

527
00:24:33,910 --> 00:24:39,460
plot the time domain so here's what a

528
00:24:36,759 --> 00:24:41,740
morley wavelet looks like you can see

529
00:24:39,460 --> 00:24:44,920
you can see the sine wave in there and

530
00:24:41,740 --> 00:24:47,640
then there's the Gaussian tapering it so

531
00:24:44,920 --> 00:24:50,529
that's very nice and here is the

532
00:24:47,640 --> 00:24:52,450
frequency representation so the

533
00:24:50,529 --> 00:24:54,279
frequency representation of a morley

534
00:24:52,450 --> 00:24:56,380
wavelet is a Gaussian or I should say

535
00:24:54,279 --> 00:24:59,920
the shape of a morley wavelet in the

536
00:24:56,380 --> 00:25:03,190
frequency domain is a Gaussian but again

537
00:24:59,920 --> 00:25:05,500
I don't want to focus on the the shape

538
00:25:03,190 --> 00:25:07,600
or the characteristics of this signal

539
00:25:05,500 --> 00:25:09,970
what we really want to do is compare

540
00:25:07,599 --> 00:25:11,740
what happens when we make this same

541
00:25:09,970 --> 00:25:14,019
signal in the time domain and the

542
00:25:11,740 --> 00:25:15,579
frequency domain using these two

543
00:25:14,019 --> 00:25:18,539
different sampling rates and these two

544
00:25:15,579 --> 00:25:18,539
different periods of time

545
00:25:20,579 --> 00:25:29,470
so first let's zoom into the time domain

546
00:25:24,359 --> 00:25:33,639
signal and what you can see is that the

547
00:25:29,470 --> 00:25:37,630
the signals represented by the the black

548
00:25:33,640 --> 00:25:39,370
circle and the magenta stars are exactly

549
00:25:37,630 --> 00:25:41,470
the same they have the same number of pi

550
00:25:39,369 --> 00:25:43,689
points so the same temporal resolution

551
00:25:41,470 --> 00:25:46,569
that's not surprising you see they both

552
00:25:43,690 --> 00:25:49,299
have the same sampling rate and the blue

553
00:25:46,569 --> 00:25:51,909
signal is follows the same same shape

554
00:25:49,299 --> 00:25:53,619
but it has many more time points and is

555
00:25:51,910 --> 00:25:57,009
also of course makes sense because the

556
00:25:53,619 --> 00:25:59,769
sampling rate is much higher so now they

557
00:25:57,009 --> 00:26:02,799
all look like they're overlapping in

558
00:25:59,769 --> 00:26:05,670
this view but in fact if we were to move

559
00:26:02,799 --> 00:26:10,930
this signal over you can see that the

560
00:26:05,670 --> 00:26:12,940
the so the the yeah two of these signals

561
00:26:10,930 --> 00:26:15,039
are only two seconds long so they stop

562
00:26:12,940 --> 00:26:17,610
here at one because it starts at minus

563
00:26:15,039 --> 00:26:20,859
one and the signal represented by the

564
00:26:17,609 --> 00:26:24,549
magenta stars is 11 seconds long so this

565
00:26:20,859 --> 00:26:26,679
goes all the way out to ten okay so

566
00:26:24,549 --> 00:26:27,220
that's pretty straightforward in the

567
00:26:26,680 --> 00:26:31,600
time too

568
00:26:27,220 --> 00:26:37,210
now let's look at these functions again

569
00:26:31,599 --> 00:26:39,699
in the frequency domain so here we see

570
00:26:37,210 --> 00:26:41,319
the Gaussian again and now things look a

571
00:26:39,700 --> 00:26:44,679
little bit different because now it's

572
00:26:41,319 --> 00:26:46,509
the the signal represented by the the

573
00:26:44,679 --> 00:26:48,038
blue dots so the blue dots are

574
00:26:46,509 --> 00:26:49,900
unfortunately a bit difficult to see but

575
00:26:48,038 --> 00:26:51,849
hopefully more clear in your screen the

576
00:26:49,900 --> 00:26:55,600
blue dots and the black circles those

577
00:26:51,849 --> 00:26:58,719
have overlapping points in the frequency

578
00:26:55,599 --> 00:27:00,668
domain and what those two signals have

579
00:26:58,720 --> 00:27:02,259
in common is that they have the same

580
00:27:00,669 --> 00:27:04,210
length notice that they have different

581
00:27:02,259 --> 00:27:07,359
sampling rates so the sampling rate of

582
00:27:04,210 --> 00:27:10,659
the blue dots is 10 times higher than

583
00:27:07,359 --> 00:27:13,209
the sampling rate of the black circles

584
00:27:10,659 --> 00:27:15,130
or the signal represented by the black

585
00:27:13,210 --> 00:27:16,960
circles but they have the same amount of

586
00:27:15,130 --> 00:27:22,240
time and here in the frequency domain

587
00:27:16,960 --> 00:27:25,390
they have the same resolution um but the

588
00:27:22,240 --> 00:27:29,048
signal represented by the magenta star

589
00:27:25,390 --> 00:27:30,700
in contrast has many more points in the

590
00:27:29,048 --> 00:27:33,220
frequency domain so the frequency

591
00:27:30,700 --> 00:27:35,259
resolution is much higher even though

592
00:27:33,220 --> 00:27:36,909
the sampling rate is not higher it's the

593
00:27:35,259 --> 00:27:39,220
amount of time that's higher so the

594
00:27:36,909 --> 00:27:40,720
frequency resolution is actually a

595
00:27:39,220 --> 00:27:44,558
little bit different from how it works

596
00:27:40,720 --> 00:27:47,650
in the time domain so here we see that

597
00:27:44,558 --> 00:27:52,178
the frequency resolution is determined

598
00:27:47,650 --> 00:27:53,830
not by the not by the sampling rate but

599
00:27:52,179 --> 00:27:56,679
by the number of time points by the

600
00:27:53,829 --> 00:27:58,750
amount of total time that we have and

601
00:27:56,679 --> 00:28:03,820
here you see also the difference between

602
00:27:58,750 --> 00:28:05,619
these signals these for the two signals

603
00:28:03,819 --> 00:28:08,109
that have a sampling rate of 100 Hertz

604
00:28:05,619 --> 00:28:10,389
they both stop at 50 and for the

605
00:28:08,109 --> 00:28:13,269
sampling for the signal at a sample that

606
00:28:10,390 --> 00:28:17,679
1000 Hertz is with blue dots then it

607
00:28:13,269 --> 00:28:20,529
goes all the way up to 500 Hertz right

608
00:28:17,679 --> 00:28:23,409
because here is the Nyquist frequency of

609
00:28:20,529 --> 00:28:26,798
the signal represented by the blue dots

610
00:28:23,409 --> 00:28:31,120
and here is the Nyquist frequency 50

611
00:28:26,798 --> 00:28:35,680
Hertz of these signals represented by by

612
00:28:31,119 --> 00:28:39,399
these other guys okay so this is a

613
00:28:35,680 --> 00:28:42,100
subtle but important points that the the

614
00:28:39,400 --> 00:28:44,140
frequency resolution is not determined

615
00:28:42,099 --> 00:28:46,149
by the sampling rate is determined only

616
00:28:44,140 --> 00:28:48,610
by the number of time points that you

617
00:28:46,150 --> 00:28:51,040
have what is determined by the sampling

618
00:28:48,609 --> 00:28:54,069
rate is the highest frequency that you

619
00:28:51,039 --> 00:28:56,920
can measure so 50 Hertz or 500 Hertz for

620
00:28:54,069 --> 00:29:00,879
signals that were measured at a 100

621
00:28:56,920 --> 00:29:04,390
Hertz or 1 kilohertz so if you find this

622
00:29:00,880 --> 00:29:06,640
still a little bit unintuitive for it or

623
00:29:04,390 --> 00:29:08,140
a little bit hard to grasp then I

624
00:29:06,640 --> 00:29:10,090
encourage you to go through this

625
00:29:08,140 --> 00:29:12,220
simulation again and try changing these

626
00:29:10,089 --> 00:29:14,740
sampling rates and change the time

627
00:29:12,220 --> 00:29:17,319
durations and hopefully this will start

628
00:29:14,740 --> 00:29:19,240
making more intuitive sense to you so

629
00:29:17,319 --> 00:29:22,329
it's an important point and you don't

630
00:29:19,240 --> 00:29:27,179
want to make mistakes

631
00:29:22,329 --> 00:29:29,980
in this because because if you don't get

632
00:29:27,179 --> 00:29:32,440
this point then you will then there's a

633
00:29:29,980 --> 00:29:35,200
risk that you will incorrectly construct

634
00:29:32,440 --> 00:29:36,519
this vector of frequencies in Hertz and

635
00:29:35,200 --> 00:29:38,140
then you will completely be

636
00:29:36,519 --> 00:29:44,039
misinterpreting the frequency

637
00:29:38,140 --> 00:29:47,650
characteristics of the data okay so now

638
00:29:44,039 --> 00:29:50,829
Patrick McGoohan is still on the prowl

639
00:29:47,650 --> 00:29:53,500
and he says well he accuses 4ei of being

640
00:29:50,829 --> 00:29:56,289
a cool man because he gives us only the

641
00:29:53,500 --> 00:30:01,599
frequency resolution that we have

642
00:29:56,289 --> 00:30:03,940
available data for and but it turns out

643
00:30:01,599 --> 00:30:07,269
for EA's is not such a cool man he says

644
00:30:03,940 --> 00:30:09,580
he can give us more frequencies if we

645
00:30:07,269 --> 00:30:12,039
want but we we don't get more precision

646
00:30:09,579 --> 00:30:13,839
he doesn't give us a better precision we

647
00:30:12,039 --> 00:30:17,609
can increase the resolution of the

648
00:30:13,839 --> 00:30:20,740
Fourier transform but not the precision

649
00:30:17,609 --> 00:30:22,779
okay and so now Patrick McGoohan

650
00:30:20,740 --> 00:30:25,779
interest is piqued and he wants to know

651
00:30:22,779 --> 00:30:27,549
how this works and Fourier says well

652
00:30:25,779 --> 00:30:29,829
this works by something called zero

653
00:30:27,549 --> 00:30:32,200
petting so now let's talk a little bit

654
00:30:29,829 --> 00:30:35,710
about zero padding and the effect of

655
00:30:32,200 --> 00:30:39,730
zero padding on on frequency resolution

656
00:30:35,710 --> 00:30:43,900
in the Fourier transform so here we have

657
00:30:39,730 --> 00:30:45,250
a signal and what we are going to do is

658
00:30:43,900 --> 00:30:46,900
zero pad

659
00:30:45,250 --> 00:30:49,269
signal so you can probably guess what

660
00:30:46,900 --> 00:30:51,220
zero petting means it really means you

661
00:30:49,269 --> 00:30:54,339
it just means that you pad the signal

662
00:30:51,220 --> 00:30:56,110
with a bunch of zeros so in this case we

663
00:30:54,339 --> 00:30:58,149
just tack on a bunch of zeros to the end

664
00:30:56,109 --> 00:31:01,059
of the signal it's important to remember

665
00:30:58,150 --> 00:31:03,610
that whenever you zero pad in the

666
00:31:01,059 --> 00:31:05,679
Fourier transform you always put the

667
00:31:03,609 --> 00:31:07,809
zeros at the end you don't put the zeros

668
00:31:05,680 --> 00:31:09,789
in the beginning you don't intermingle

669
00:31:07,809 --> 00:31:13,059
the zeros with the signal all the zeros

670
00:31:09,789 --> 00:31:16,420
go at the end so this is now an

671
00:31:13,059 --> 00:31:20,440
interesting concept because now we're

672
00:31:16,420 --> 00:31:22,570
getting more we have more data points in

673
00:31:20,440 --> 00:31:25,420
a time domain which means we are going

674
00:31:22,569 --> 00:31:28,059
to get a higher frequency resolution we

675
00:31:25,420 --> 00:31:30,910
can extract more frequencies between 0

676
00:31:28,059 --> 00:31:34,450
and the Nyquist frequency but on the

677
00:31:30,910 --> 00:31:36,490
other hand we haven't actually added any

678
00:31:34,450 --> 00:31:38,200
information so there's nothing new in

679
00:31:36,490 --> 00:31:40,240
this signal we're just adding a bunch of

680
00:31:38,200 --> 00:31:42,640
zeros we're not getting any more

681
00:31:40,240 --> 00:31:46,120
information out of the signal that we

682
00:31:42,640 --> 00:31:48,220
had before in this case but we are

683
00:31:46,119 --> 00:31:50,889
getting more frequencies so this is how

684
00:31:48,220 --> 00:31:53,110
we can zero pad to increase the

685
00:31:50,890 --> 00:31:55,030
frequency resolution of the data

686
00:31:53,109 --> 00:31:57,189
although we're not increasing the

687
00:31:55,029 --> 00:31:58,990
frequency precision of the data because

688
00:31:57,190 --> 00:32:01,000
we don't actually have any more

689
00:31:58,990 --> 00:32:06,220
information in the signal than what we

690
00:32:01,000 --> 00:32:09,910
started with okay so now we can see how

691
00:32:06,220 --> 00:32:12,970
this is going to work in MATLAB so what

692
00:32:09,910 --> 00:32:15,040
I'm going to do now is so this is just

693
00:32:12,970 --> 00:32:17,380
redefining the signal from from the

694
00:32:15,039 --> 00:32:19,420
first section what we're going to do is

695
00:32:17,380 --> 00:32:22,210
compute the Fourier transform of this

696
00:32:19,420 --> 00:32:25,779
signal and we're going to utilize the

697
00:32:22,210 --> 00:32:29,110
second input into the function f of T

698
00:32:25,779 --> 00:32:31,210
and the second input is the N of the f

699
00:32:29,109 --> 00:32:33,759
of T or the number of time points to use

700
00:32:31,210 --> 00:32:37,539
for the end for the when computing the

701
00:32:33,759 --> 00:32:41,859
Fourier transform now if you want to

702
00:32:37,539 --> 00:32:43,329
zero path so this is a useful useful

703
00:32:41,859 --> 00:32:45,429
input because it means that we don't

704
00:32:43,329 --> 00:32:47,619
need to zero pad manually we don't need

705
00:32:45,430 --> 00:32:48,509
to take our signal and figure out how

706
00:32:47,619 --> 00:32:49,978
many

707
00:32:48,509 --> 00:32:52,798
want to add and just add them in like

708
00:32:49,979 --> 00:32:55,679
this instead we take the the actual

709
00:32:52,798 --> 00:32:58,078
signal that we have measured and if we

710
00:32:55,679 --> 00:33:02,519
went to zero pad we just add more

711
00:32:58,078 --> 00:33:04,378
numbers to the second input so but you

712
00:33:02,519 --> 00:33:06,929
do have to keep in mind that this input

713
00:33:04,378 --> 00:33:09,208
is the total length of the Fourier

714
00:33:06,929 --> 00:33:12,629
transform that you want to compute not

715
00:33:09,209 --> 00:33:15,209
the number of zeros that you want to pad

716
00:33:12,628 --> 00:33:18,509
at the end so if we were to do something

717
00:33:15,209 --> 00:33:21,139
like this we see the signal is 14 points

718
00:33:18,509 --> 00:33:24,179
long but here we are taking the FFT

719
00:33:21,138 --> 00:33:27,178
using an N of 10 this would actually

720
00:33:24,179 --> 00:33:29,278
mean that that MATLAB is going to

721
00:33:27,179 --> 00:33:32,309
truncate is going to delete the last

722
00:33:29,278 --> 00:33:34,229
four points of this signal so that we

723
00:33:32,308 --> 00:33:37,678
get only 10 points so this is not what

724
00:33:34,229 --> 00:33:41,308
we want we want the length of the signal

725
00:33:37,679 --> 00:33:45,538
and then plus however many zeros we want

726
00:33:41,308 --> 00:33:48,558
pad at the end okay so here we compute

727
00:33:45,538 --> 00:33:51,058
the Fourier transforms of these three

728
00:33:48,558 --> 00:33:54,959
well it's the same signal but just with

729
00:33:51,058 --> 00:33:57,418
different 0 padding here I define the

730
00:33:54,959 --> 00:33:59,788
frequencies vector now here I'm not

731
00:33:57,419 --> 00:34:01,288
specifying what the time unit is we we

732
00:33:59,788 --> 00:34:03,690
don't know how to convert this into

733
00:34:01,288 --> 00:34:06,209
Hertz so instead I'm just leaving these

734
00:34:03,690 --> 00:34:10,349
frequencies vectors in terms of a

735
00:34:06,209 --> 00:34:12,480
fraction of the sampling rate so that

736
00:34:10,349 --> 00:34:15,359
means we always go from 0 and now here

737
00:34:12,480 --> 00:34:17,128
we're going to stop at 0.5 which is half

738
00:34:15,358 --> 00:34:19,440
of these sampling rates so now we don't

739
00:34:17,128 --> 00:34:21,480
need to worry about units and you can

740
00:34:19,440 --> 00:34:25,398
see that what's going to differ between

741
00:34:21,480 --> 00:34:27,690
these three frequencies vectors is

742
00:34:25,398 --> 00:34:32,159
whether it comes from the length of

743
00:34:27,690 --> 00:34:36,929
signal 1 signal 2 or signal 3 okay so

744
00:34:32,159 --> 00:34:39,898
first let's plot these signals in the

745
00:34:36,929 --> 00:34:41,548
time domain and again we're plugging in

746
00:34:39,898 --> 00:34:43,679
the time domain by taking the inverse

747
00:34:41,548 --> 00:34:46,288
Fourier transform so you can see that

748
00:34:43,679 --> 00:34:49,470
the signals are all exactly the same for

749
00:34:46,289 --> 00:34:52,019
the first 14 points and then one of the

750
00:34:49,469 --> 00:34:55,199
signal stops here the other signal will

751
00:34:52,018 --> 00:34:56,108
be 0 padded 10 times or sorry we 0

752
00:34:55,199 --> 00:35:00,248
padded

753
00:34:56,108 --> 00:35:02,348
ten zeros that stops here and then the

754
00:35:00,248 --> 00:35:04,118
third signal where we zero padded with a

755
00:35:02,349 --> 00:35:08,349
hundred zeros that goes all the way out

756
00:35:04,119 --> 00:35:10,749
here to 114 so this is how it looks in

757
00:35:08,349 --> 00:35:14,980
the time domain and now let's take a

758
00:35:10,748 --> 00:35:18,238
look at the frequency domain so here in

759
00:35:14,980 --> 00:35:21,159
blue is the Fourier transform of the

760
00:35:18,239 --> 00:35:23,970
original signal so I call it the native

761
00:35:21,159 --> 00:35:26,348
end so this is just an N of fourteen

762
00:35:23,969 --> 00:35:29,169
this is the these are the actual

763
00:35:26,349 --> 00:35:31,690
frequencies that we really truly have in

764
00:35:29,170 --> 00:35:35,619
the data that we can really measure and

765
00:35:31,690 --> 00:35:38,739
you can see that as we add more zeros as

766
00:35:35,619 --> 00:35:40,660
we add as we increase our n the plot

767
00:35:38,739 --> 00:35:43,720
looks a little bit smoother going up to

768
00:35:40,659 --> 00:35:45,639
where we get n plus one hundreds over

769
00:35:43,719 --> 00:35:47,768
zero petting by 100 here it actually

770
00:35:45,639 --> 00:35:49,719
looks quite pretty if we have this nice

771
00:35:47,768 --> 00:35:53,528
smooth function and it seems like

772
00:35:49,719 --> 00:35:55,719
they're these kind of yeah very smooth

773
00:35:53,528 --> 00:36:00,429
gentle hills in the in the Fourier

774
00:35:55,719 --> 00:36:01,778
transform so you have to be careful when

775
00:36:00,429 --> 00:36:05,440
interpreting this because it's very

776
00:36:01,778 --> 00:36:09,670
tempting to interpret this signal here

777
00:36:05,440 --> 00:36:12,519
as being the you know one point seven or

778
00:36:09,670 --> 00:36:15,519
point one seven frequency component of

779
00:36:12,518 --> 00:36:16,868
the signal but it's the interpretation

780
00:36:15,518 --> 00:36:20,518
this point is a little bit more subtle

781
00:36:16,869 --> 00:36:22,749
because we do not actually measure this

782
00:36:20,518 --> 00:36:24,669
component in a signal in fact this

783
00:36:22,748 --> 00:36:26,308
component does not exist in our signal

784
00:36:24,670 --> 00:36:29,200
because we don't have enough time points

785
00:36:26,309 --> 00:36:32,950
this is just an estimate this is the

786
00:36:29,199 --> 00:36:35,710
Fourier transforms guess at what this

787
00:36:32,949 --> 00:36:40,268
component in the signal might be if

788
00:36:35,710 --> 00:36:43,199
there were actually data at that at that

789
00:36:40,268 --> 00:36:45,518
frequency if we add enough time points

790
00:36:43,199 --> 00:36:49,088
so you can also see it looks very smooth

791
00:36:45,518 --> 00:36:52,748
in fact it is it is a sinc interpolated

792
00:36:49,088 --> 00:36:56,259
signal and in fact this is one of the

793
00:36:52,748 --> 00:36:57,939
ways of sinc interpolating a signal just

794
00:36:56,259 --> 00:36:59,858
by taking the Fourier transform with a

795
00:36:57,940 --> 00:37:01,838
higher and this is called

796
00:36:59,858 --> 00:37:04,568
I believe it's called the zero padding

797
00:37:01,838 --> 00:37:07,170
theorem that describes the relationship

798
00:37:04,568 --> 00:37:10,679
between zero cutting a signal

799
00:37:07,170 --> 00:37:17,700
and and the sync interpolated version in

800
00:37:10,679 --> 00:37:20,609
the frequency domain okay so why would

801
00:37:17,699 --> 00:37:23,129
you want to zero pad the signal there

802
00:37:20,610 --> 00:37:25,620
are three motivations three reasons why

803
00:37:23,130 --> 00:37:28,019
you might want to zero pad your signal

804
00:37:25,619 --> 00:37:30,900
during the Fourier transform one is if

805
00:37:28,019 --> 00:37:32,550
you want to obtain an estimate of a very

806
00:37:30,900 --> 00:37:34,980
specific frequency that you don't

807
00:37:32,550 --> 00:37:36,539
natively get from the from the data

808
00:37:34,980 --> 00:37:41,789
because you don't have enough time

809
00:37:36,539 --> 00:37:44,159
points the second is the reason that

810
00:37:41,789 --> 00:37:47,730
will be used most often for time

811
00:37:44,159 --> 00:37:50,210
frequency analysis and that is to match

812
00:37:47,730 --> 00:37:53,789
the lengths of the Fourier transforms

813
00:37:50,210 --> 00:37:55,740
for a signal and a kernel during the

814
00:37:53,789 --> 00:37:57,509
course of convolution if you don't

815
00:37:55,739 --> 00:37:59,879
really understand what this means don't

816
00:37:57,510 --> 00:38:02,160
worry about it we will discuss this

817
00:37:59,880 --> 00:38:03,510
point when we talk about convolution in

818
00:38:02,159 --> 00:38:06,719
the near future

819
00:38:03,510 --> 00:38:08,790
and finally you can also zero ped just

820
00:38:06,719 --> 00:38:10,500
to interpolate the results just to make

821
00:38:08,789 --> 00:38:12,570
them look that smoother and a bit

822
00:38:10,500 --> 00:38:15,809
prettier this is fine it's a decent

823
00:38:12,570 --> 00:38:17,640
motivation but just be careful to to

824
00:38:15,809 --> 00:38:20,039
interpret the results correctly because

825
00:38:17,639 --> 00:38:22,759
these smoother plots are just sync

826
00:38:20,039 --> 00:38:26,489
interpolated and you don't necessarily

827
00:38:22,760 --> 00:38:29,280
have the ability to to MIT so these are

828
00:38:26,489 --> 00:38:31,409
just estimates of what the signal at

829
00:38:29,280 --> 00:38:35,820
that frequency might be if you had

830
00:38:31,409 --> 00:38:37,710
enough data okay so I hope that was

831
00:38:35,820 --> 00:38:42,380
useful and I hope you enjoyed seeing

832
00:38:37,710 --> 00:38:44,639
Patrick go and show his face again and

833
00:38:42,380 --> 00:38:46,970
look forward to seeing you in the next

834
00:38:44,639 --> 00:38:46,969
lecture

